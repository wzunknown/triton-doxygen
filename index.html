<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Triton: Dynamic Binary Analysis Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libTriton
   &#160;<span id="projectnumber">version 0.9 build 1503</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Triton: Dynamic Binary Analysis Framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#description_sec">Description</a></li>
<li class="level1"><a href="#publications_sec">Presentations and Publications</a></li>
<li class="level1"><a href="#install_sec">Installation</a><ul><li class="level2"><a href="#linux_install_sec">Linux Installation</a></li>
<li class="level2"><a href="#osx_install_sec">OSX Installation</a></li>
<li class="level2"><a href="#windows_install_sec">Windows Installation</a></li>
<li class="level2"><a href="#libpintool_install_sec">Pintool for Linux users</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="description_sec"></a>
Description</h1>
<p><b>Triton</b> is a dynamic binary analysis (DBA) framework. It provides internal components like a <b>Dynamic Symbolic Execution</b> (DSE) engine, a <b>Taint</b> engine, <b>AST representations</b> of the <b>x86</b>, <b>x86-64</b>, <b>ARM32</b> and <b>AArch64</b> instructions set architecture (ISA), <b>SMT simplification</b> passes, an <b>SMT solver</b> interface and, the last but not least, <b>Python bindings</b>.</p>
<p><br />
 </p><hr/>
 <h1><a class="anchor" id="publications_sec"></a>
Presentations and Publications</h1>
<ul>
<li>
<p class="startli"><b>Symbolic Deobfuscation: From Virtualized Code Back to the Original</b><br />
 Talk at DIMVA, Paris-Saclay, 2018. [<a href="https://triton.quarkslab.com/files/DIMVA2018-deobfuscation-salwan-bardin-potet.pdf">paper</a>] [<a href="https://triton.quarkslab.com/files/DIMVA2018-slide-deobfuscation-salwan-bardin-potet.pdf">slide</a>] [<a href="https://triton.quarkslab.com/files/DeobfuscationDIMVA2018.txt">bibtex</a>]<br />
 Abstract: <em>Software protection has taken an important place during the last decade in order to protect legit software against reverse engineering or tampering. Virtualization is considered as one of the very best defenses against such attacks. We present a generic approach based on symbolic path exploration, taint and recompilation allowing to recover, from a virtualized code, a devirtualized code semantically identical to the original one and close in size. We define criteria and metrics to evaluate the relevance of the deobfuscated results in terms of correctness and precision. Finally we propose an open-source setup allowing to evaluate the proposed approach against several forms of virtualization. </em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Deobfuscation of VM based software protection </b><br />
 Talk at SSTIC, Rennes, 2017. [<a href="https://triton.quarkslab.com/files/sstic2017-salwan-bardin-potet-paper.pdf">french paper</a>] [<a href="https://triton.quarkslab.com/files/sstic2017-salwan-bardin-potet-slide.pdf">english slide</a>] [<a href="https://static.sstic.org/videos2017/SSTIC_2017-06-07_P08.mp4">french video</a>] [<a href="https://triton.quarkslab.com/files/DeobfuscationSSTIC2017.txt">bibtex</a>]<br />
 Abstract: <em>In this presentation we describe an approach which consists to automatically analyze virtual machine based software protections and which recompiles a new version of the binary without such protections. This automated approach relies on a symbolic execution guide by a taint analysis and some concretization policies, then on a binary rewriting using LLVM transition. </em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>How Triton can help to reverse virtual machine based software protections</b><br />
 Talk at CSAW SOS, NYC, 2016. [<a href="https://triton.quarkslab.com/files/csaw2016-sos-rthomas-jsalwan.pdf">slide</a>]<br />
 Abstract: <em>The first part of the talk is going to be an introduction to the Triton framework to expose its components and to explain how they work together. Then, the second part will include demonstrations on how it's possible to reverse virtual machine based protections using taint analysis, symbolic execution, SMT simplifications and LLVM-IR optimizations. </em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Dynamic Binary Analysis and Obfuscated Codes</b><br />
 Talk at St'Hack, Bordeaux, 2016. [<a href="https://triton.quarkslab.com/files/sthack2016-rthomas-jsalwan.pdf">slide</a>]<br />
 Abstract: <em>At this presentation we will talk about how a DBA (Dynamic Binary Analysis) may help a reverse engineer to reverse obfuscated code. We will first introduce some basic obfuscation techniques and then expose how it's possible to break some stuffs (using our open-source DBA framework - Triton) like detect opaque predicates, reconstruct CFG, find the original algorithm, isolate sensible data and many more... Then, we will conclude with a demo and few words about our future work. </em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>How Triton may help to analyse obfuscated binaries</b><br />
 MISC magazine 82, 2015. [<a href="https://triton.quarkslab.com/files/misc82-triton.pdf">french article</a>]<br />
 Abstract: <em>Binary obfuscation is used to protect software's intellectual property. There exist different kinds of obfucation but roughly, it transforms a binary structure into another binary structure by preserving the same semantic. The aim of obfuscation is to ensure that the original information is "drown" in useless information that will make reverse engineering harder. In this article we will show how we can analyse an ofbuscated program and break some obfuscations using the Triton framework.</em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Triton: A Concolic Execution Framework</b><br />
 Talk at SSTIC, Rennes, 2015. [<a href="https://triton.quarkslab.com/files/sstic2015_wp_fr_saudel_salwan.pdf">french paper</a>] [<a href="https://triton.quarkslab.com/files/sstic2015_slide_en_saudel_salwan.pdf">detailed english slide</a>] [<a href="https://triton.quarkslab.com/files/sstic2015_slide_fr_saudel_salwan.pdf">light french slide</a>] [<a href="https://triton.quarkslab.com/files/TritonSSTIC2015.txt">bibtex</a>]<br />
 Abstract: <em>This talk is about the release of Triton, a concolic execution framework based on Pin. It provides components like a taint engine, a dynamic symbolic execution engine, a snapshot engine, translation of x64 instruction to SMT2, a Z3 interface to solve constraints and Python bindings. Based on these components, Triton offers the possibility to build tools for vulnerabilities research or reverse-engineering assistance.</em></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Dynamic Behavior Analysis Using Binary Instrumentation</b><br />
 Talk at St'Hack, Bordeaux, 2015. [<a href="https://triton.quarkslab.com/files/sthack2015_salwan.pdf">slide</a>]<br />
 Abstract: <em>This talk can be considered like the part 2 of our talk at SecurityDay. In the previous part, we talked about how it was possible to cover a targeted function in memory using the DSE (Dynamic Symbolic Execution) approach. Cover a function (or its states) doesn't mean find all vulnerabilities, some vulnerability doesn't crashes the program. That's why we must implement specific analysis to find specific bugs. These analysis are based on the binary instrumentation and the runtime behavior analysis of the program. In this talk, we will see how it's possible to find these following kind of bugs : off-by-one, stack / heap overflow, use-after-free, format string and {write, read}-what-where.</em></p>
<p class="endli"></p>
</li>
<li>
<b>Covering a function using a Dynamic Symbolic Execution approach</b><br />
 Talk at Security Day, Lille, 2015. [<a href="https://triton.quarkslab.com/files/secday2015_salwan.pdf">slide</a>]<br />
 Abstract: <em>This talk is about binary analysis and instrumentation. We will see how it's possible to target a specific function, snapshot the context memory/registers before the function, translate the instrumentation into an intermediate representation,apply a taint analysis based on this IR, build/keep formulas for a Dynamic Symbolic Execution (DSE), generate a concrete value to go through a specific path, restore the context memory/register and generate another concrete value to go through another path then repeat this operation until the target function is covered.</em> </li>
</ul>
<p><br />
 </p><hr/>
 <h1><a class="anchor" id="install_sec"></a>
Installation</h1>
<p>To be able to compile Triton, you must install these libraries before:</p>
<table class="doxtable">
<tr>
<th>lib name </th><th>version  </th></tr>
<tr>
<td><a href="http://www.boost.org/">libboost</a> </td><td>&gt;= 1.68 </td></tr>
<tr>
<td><a href="https://www.python.org/">libpython</a> </td><td>== 2.7.x or 3.6.x </td></tr>
<tr>
<td><a href="https://github.com/Z3Prover/z3">libz3</a> </td><td>&gt;= 4.6.0 </td></tr>
<tr>
<td><a href="http://www.capstone-engine.org/">libcapstone</a> </td><td>&gt;= 4.0.x </td></tr>
<tr>
<td><a href="https://software.intel.com/en-us/articles/pintool-downloads">Pin</a> (optional) </td><td>== 71313 </td></tr>
</table>
<hr/>
 <h2><a class="anchor" id="linux_install_sec"></a>
Linux Installation</h2>
<p>Once the libraries are installed, you can use <code>cmake</code> and <code>make</code> to build <code>libTriton</code>.</p>
<div class="fragment"><div class="line">$ git clone https://github.com/JonathanSalwan/Triton.git</div><div class="line">$ cd Triton</div><div class="line">$ mkdir build</div><div class="line">$ cd build</div><div class="line">$ cmake ..</div><div class="line">$ sudo make -j2 install</div></div><!-- fragment --><hr/>
 <h2><a class="anchor" id="osx_install_sec"></a>
OSX Installation</h2>
<p>On OSX <code>cmake</code> might have some difficulties finding the correct Python include/library paths. You can run the following to build independent of your Python version:</p>
<div class="fragment"><div class="line">$ brew install boost capstone z3</div><div class="line">$ git clone https://github.com/JonathanSalwan/Triton.git</div><div class="line">$ cd Triton</div><div class="line">$ mkdir build</div><div class="line">$ cd build</div><div class="line">$ cmake $(echo &#39;from os.path import abspath, join; from distutils.sysconfig import get_python_inc, get_python_lib; print &quot;-DPYTHON_INCLUDE_DIR=%s -DPYTHON_LIBRARY=%s&quot; % (get_python_inc(), abspath(join(get_python_lib(), &quot;../../libpython2.7.dylib&quot;)))&#39; | python) ..</div><div class="line">$ sudo make -j2 install</div></div><!-- fragment --><hr/>
 <h2><a class="anchor" id="windows_install_sec"></a>
Windows Installation</h2>
<p>Once libraries installed, you can use <code>cmake</code> to generate the <code>.sln</code> file of <code>libTriton</code>.</p>
<div class="fragment"><div class="line">&gt; git clone https://github.com/JonathanSalwan/Triton.git</div><div class="line">&gt; cd Triton</div><div class="line">&gt; mkdir build</div><div class="line">&gt; cd build</div><div class="line">&gt; cmake -G &quot;Visual Studio 14 2015 Win64&quot; \</div><div class="line">  -DBOOST_ROOT=&quot;C:/Users/jonathan/Works/Tools/boost_1_61_0&quot; \</div><div class="line">  -DPYTHON_INCLUDE_DIRS=&quot;C:/Python27/include&quot; \</div><div class="line">  -DPYTHON_LIBRARIES=&quot;C:/Python27/libs/python27.lib&quot; \</div><div class="line">  -DZ3_INCLUDE_DIRS=&quot;C:/Users/jonathan/Works/Tools/z3-4.6.0-x64-win/include&quot; \</div><div class="line">  -DZ3_LIBRARIES=&quot;C:/Users/jonathan/Works/Tools/z3-4.6.0-x64-win/bin/libz3.lib&quot; \</div><div class="line">  -DCAPSTONE_INCLUDE_DIRS=&quot;C:/Users/jonathan/Works/Tools/capstone-3.0.5-win64/include&quot; \</div><div class="line">  -DCAPSTONE_LIBRARIES=&quot;C:/Users/jonathan/Works/Tools/capstone-3.0.5-win64/capstone.lib&quot; ..</div></div><!-- fragment --><p>However, if you prefer to directly download precompiled libraries, check out our <a href="https://ci.appveyor.com/project/JonathanSalwan/triton/history">AppVeyor's artefacts</a>. Note that if you use AppVeyor's artefacts, you probably have to install the <a href="https://www.microsoft.com/en-US/download/details.aspx?id=30679">Visual C++ Redistributable</a> packages for Visual Studio 2012.</p>
<hr/>
 <h2><a class="anchor" id="libpintool_install_sec"></a>
Pintool for Linux users</h2>
<p>This project is also shipped with a <a class="el" href="Tracer_page.html">Pintool tracer</a> and may be compiled with these following commands:</p>
<div class="fragment"><div class="line">$ cd pin-2.14-71313-gcc.4.4.7-linux/source/tools/</div><div class="line">$ git clone https://github.com/JonathanSalwan/Triton.git</div><div class="line">$ cd Triton</div><div class="line">$ mkdir build</div><div class="line">$ cd build</div><div class="line">$ cmake -DPINTOOL=on ..</div><div class="line">$ make -j2</div><div class="line">$ cd ..</div><div class="line">$ ./build/triton ./src/examples/pin/ir.py /usr/bin/id</div></div><!-- fragment --><p>It's not recommended to use the pintool on a kernel <code>4.x</code>. The version <code>71313</code> of Pin doesn't support very well this branch (<code>4.x</code>). Anyway, if you feel lucky, you can compile the Triton pintool with the <code>-DKERNEL4=on</code> flag.</p>
<div class="fragment"><div class="line">$ cmake -DPINTOOL=on -DKERNEL4=on ..</div><div class="line">$ make</div></div><!-- fragment --><p>Note that only the version <code>71313</code> of Pin is supported. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
